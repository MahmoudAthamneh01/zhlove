(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[343],{3008:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});var s=r(2898);/**
 * @license lucide-react v0.302.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s.Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},9670:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});var s=r(2898);/**
 * @license lucide-react v0.302.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s.Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},3505:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});var s=r(2898);/**
 * @license lucide-react v0.302.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s.Z)("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]])},2882:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});var s=r(2898);/**
 * @license lucide-react v0.302.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s.Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},1827:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});var s=r(2898);/**
 * @license lucide-react v0.302.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s.Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},5367:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});var s=r(2898);/**
 * @license lucide-react v0.302.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s.Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},1779:function(e,t,r){Promise.resolve().then(r.bind(r,2142))},2142:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return ContentModerationPage}});var s=r(7437),n=r(2265),a=r(609),c=r(3089),o=r(6582),i=r(150),l=r(2882),d=r(1827),h=r(3505),u=r(9670),m=r(5367),f=r(3008),p=r(2898);/**
 * @license lucide-react v0.302.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let x=(0,p.Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),b=(0,p.Z)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);function ContentModerationPage(e){let{params:{locale:t}}=e,[r,p]=(0,n.useState)("posts"),[y,g]=(0,n.useState)([]),[v,j]=(0,n.useState)([]),[N,z]=(0,n.useState)(!0),[w,k]=(0,n.useState)("");(0,n.useEffect)(()=>{"posts"===r?fetchPosts():fetchReports()},[r,w]);let fetchPosts=async()=>{try{let e=new URLSearchParams({search:w,includeReported:"true"}),t=await fetch("/api/admin/content/posts?".concat(e)),r=await t.json();g(r.posts||[])}catch(e){console.error("Failed to fetch posts:",e)}finally{z(!1)}},fetchReports=async()=>{try{let e=new URLSearchParams({status:"pending"}),t=await fetch("/api/admin/content/reports?".concat(e)),r=await t.json();j(r.reports||[])}catch(e){console.error("Failed to fetch reports:",e)}finally{z(!1)}},moderatePost=async(e,t)=>{try{let r=await fetch("/api/admin/content/posts/".concat(e,"/moderate"),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:t})});r.ok&&fetchPosts()}catch(e){console.error("Failed to moderate post:",e)}},handleReport=async(e,t)=>{try{let r=await fetch("/api/admin/content/reports/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"approve"===t?"approved":"dismissed"})});r.ok&&fetchReports()}catch(e){console.error("Failed to handle report:",e)}};return N?(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsx)("div",{className:"w-8 h-8 border-2 border-zh-accent/20 border-t-zh-accent rounded-full animate-spin"})}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{children:[(0,s.jsxs)("h1",{className:"text-3xl font-bold text-white flex items-center gap-2",children:[(0,s.jsx)(l.Z,{className:"h-8 w-8"}),"Content Moderation"]}),(0,s.jsx)("p",{className:"text-zh-border",children:"Moderate posts, comments, and handle reports"})]})}),(0,s.jsxs)("div",{className:"flex space-x-4 border-b border-zh-border/20",children:[(0,s.jsxs)("button",{onClick:()=>p("posts"),className:"pb-4 px-2 font-medium transition-colors ".concat("posts"===r?"text-zh-accent border-b-2 border-zh-accent":"text-zh-border hover:text-white"),children:["Posts (",y.length,")"]}),(0,s.jsxs)("button",{onClick:()=>p("reports"),className:"pb-4 px-2 font-medium transition-colors ".concat("reports"===r?"text-zh-accent border-b-2 border-zh-accent":"text-zh-border hover:text-white"),children:["Reports (",v.length,")"]})]}),(0,s.jsx)(a.Zb,{className:"zh-card",children:(0,s.jsx)(a.aY,{className:"p-4",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(d.Z,{className:"absolute left-3 top-3 h-4 w-4 text-zh-border"}),(0,s.jsx)(o.I,{placeholder:"Search ".concat(r,"..."),value:w,onChange:e=>k(e.target.value),className:"pl-10"})]})})}),"posts"===r&&(0,s.jsx)("div",{className:"space-y-4",children:y.map(e=>(0,s.jsxs)(a.Zb,{className:"zh-card",children:[(0,s.jsx)(a.Ol,{className:"pb-3",children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)(a.ll,{className:"text-white text-lg",children:e.title}),(0,s.jsxs)("p",{className:"text-sm text-zh-border mt-1",children:["by @",e.author.username," • ",new Date(e.createdAt).toLocaleDateString()]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(i.C,{className:"".concat("active"===e.status?"bg-green-500":"removed"===e.status?"bg-red-500":"bg-yellow-500"," text-white"),children:e.status}),e._count.reports>0&&(0,s.jsxs)(i.C,{className:"bg-red-500 text-white",children:[(0,s.jsx)(h.Z,{className:"h-3 w-3 mr-1"}),e._count.reports]})]})]})}),(0,s.jsxs)(a.aY,{className:"pt-0",children:[(0,s.jsx)("p",{className:"text-zh-border text-sm mb-4 line-clamp-3",children:e.content}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 text-sm text-zh-border",children:[(0,s.jsxs)("span",{children:[e._count.comments," comments"]}),(0,s.jsxs)("span",{children:[e._count.likes," likes"]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(c.z,{variant:"secondary",size:"sm",children:[(0,s.jsx)(u.Z,{className:"h-4 w-4 mr-1"}),"View"]}),"active"===e.status?(0,s.jsxs)(c.z,{variant:"destructive",size:"sm",onClick:()=>moderatePost(e.id,"remove"),children:[(0,s.jsx)(m.Z,{className:"h-4 w-4 mr-1"}),"Remove"]}):(0,s.jsxs)(c.z,{variant:"secondary",size:"sm",onClick:()=>moderatePost(e.id,"approve"),children:[(0,s.jsx)(f.Z,{className:"h-4 w-4 mr-1"}),"Restore"]})]})]})]})]},e.id))}),"reports"===r&&(0,s.jsx)("div",{className:"space-y-4",children:v.map(e=>(0,s.jsxs)(a.Zb,{className:"zh-card",children:[(0,s.jsx)(a.Ol,{className:"pb-3",children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)(a.ll,{className:"text-white text-lg flex items-center gap-2",children:[(0,s.jsx)(x,{className:"h-5 w-5 text-yellow-500"}),e.type," Report"]}),(0,s.jsxs)("p",{className:"text-sm text-zh-border mt-1",children:["Reported by @",e.reporter.username," • ",new Date(e.reportedAt).toLocaleDateString()]})]}),(0,s.jsx)(i.C,{className:"bg-yellow-500 text-white",children:e.status})]})}),(0,s.jsxs)(a.aY,{className:"pt-0",children:[(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("h4",{className:"text-white font-medium mb-2",children:"Reason:"}),(0,s.jsx)("p",{className:"text-zh-border text-sm",children:e.reason})]}),e.post&&(0,s.jsxs)("div",{className:"mb-4 p-3 bg-zh-container rounded-lg",children:[(0,s.jsx)("h4",{className:"text-white font-medium mb-1",children:"Reported Post:"}),(0,s.jsxs)("p",{className:"text-sm text-zh-border",children:['"',e.post.title,'" by @',e.post.author.username]})]}),e.comment&&(0,s.jsxs)("div",{className:"mb-4 p-3 bg-zh-container rounded-lg",children:[(0,s.jsx)("h4",{className:"text-white font-medium mb-1",children:"Reported Comment:"}),(0,s.jsxs)("p",{className:"text-sm text-zh-border",children:['"',e.comment.content,'" by @',e.comment.author.username]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(c.z,{variant:"destructive",size:"sm",onClick:()=>handleReport(e.id,"approve"),children:[(0,s.jsx)(f.Z,{className:"h-4 w-4 mr-1"}),"Take Action"]}),(0,s.jsxs)(c.z,{variant:"secondary",size:"sm",onClick:()=>handleReport(e.id,"dismiss"),children:[(0,s.jsx)(b,{className:"h-4 w-4 mr-1"}),"Dismiss"]})]})]})]},e.id))}),("posts"===r&&0===y.length||"reports"===r&&0===v.length)&&(0,s.jsx)(a.Zb,{className:"zh-card",children:(0,s.jsx)(a.aY,{className:"text-center py-12",children:(0,s.jsx)("div",{className:"text-zh-border",children:"posts"===r?"No posts found.":"No pending reports."})})})]})}},150:function(e,t,r){"use strict";r.d(t,{C:function(){return Badge}});var s=r(7437);r(2265);var n=r(6061),a=r(345);let c=(0,n.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-zh-accent text-white hover:bg-zh-accent/80",secondary:"border-transparent bg-zh-secondary text-white hover:bg-zh-secondary/80",destructive:"border-transparent bg-zh-red text-white hover:bg-zh-red/80",outline:"text-foreground",success:"border-transparent bg-zh-accent text-white hover:bg-zh-accent/80",warning:"border-transparent bg-zh-gold text-black hover:bg-zh-gold/80",info:"border-transparent bg-zh-blue text-white hover:bg-zh-blue/80"}},defaultVariants:{variant:"default"}});function Badge(e){let{className:t,variant:r,...n}=e;return(0,s.jsx)("div",{className:(0,a.cn)(c({variant:r}),t),...n})}},3089:function(e,t,r){"use strict";r.d(t,{z:function(){return l}});var s=r(7437),n=r(2265),a=r(7256),c=r(6061),o=r(345);let i=(0,c.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-zh-accent text-white hover:bg-zh-accent/90",destructive:"bg-zh-red text-white hover:bg-zh-red/90",outline:"border border-zh-border bg-transparent hover:bg-zh-secondary hover:text-white",secondary:"bg-zh-secondary text-white hover:bg-zh-secondary/80",ghost:"hover:bg-zh-secondary hover:text-white",link:"text-zh-blue underline-offset-4 hover:underline",gaming:"bg-gradient-to-r from-zh-accent to-zh-blue text-white hover:from-zh-accent/90 hover:to-zh-blue/90 glow-effect",gold:"bg-zh-gold text-black hover:bg-zh-gold/90",alert:"bg-zh-red text-white hover:bg-zh-red/90"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),l=n.forwardRef((e,t)=>{let{className:r,variant:n,size:c,asChild:l=!1,...d}=e,h=l?a.g7:"button";return(0,s.jsx)(h,{className:(0,o.cn)(i({variant:n,size:c,className:r})),ref:t,...d})});l.displayName="Button"},609:function(e,t,r){"use strict";r.d(t,{Ol:function(){return o},Zb:function(){return c},aY:function(){return d},ll:function(){return i}});var s=r(7437),n=r(2265),a=r(345);let c=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,a.cn)("zh-card",r),...n})});c.displayName="Card";let o=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",r),...n})});o.displayName="CardHeader";let i=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("h3",{ref:t,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",r),...n})});i.displayName="CardTitle";let l=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("p",{ref:t,className:(0,a.cn)("text-sm text-muted-foreground",r),...n})});l.displayName="CardDescription";let d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,a.cn)("p-6 pt-0",r),...n})});d.displayName="CardContent";let h=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,a.cn)("flex items-center p-6 pt-0",r),...n})});h.displayName="CardFooter"},6582:function(e,t,r){"use strict";r.d(t,{I:function(){return c}});var s=r(7437),n=r(2265),a=r(345);let c=n.forwardRef((e,t)=>{let{className:r,type:n,...c}=e;return(0,s.jsx)("input",{type:n,className:(0,a.cn)("flex h-10 w-full rounded-md border border-zh-border bg-zh-secondary px-3 py-2 text-sm text-white placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-zh-accent focus:border-transparent disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...c})});c.displayName="Input"},345:function(e,t,r){"use strict";r.d(t,{cn:function(){return cn}});var s=r(7042),n=r(4769);function cn(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.m6)((0,s.W)(t))}},2210:function(e,t,r){"use strict";r.d(t,{F:function(){return composeRefs},e:function(){return useComposedRefs}});var s=r(2265);function setRef(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function composeRefs(...e){return t=>{let r=!1,s=e.map(e=>{let s=setRef(e,t);return r||"function"!=typeof s||(r=!0),s});if(r)return()=>{for(let t=0;t<s.length;t++){let r=s[t];"function"==typeof r?r():setRef(e[t],null)}}}}function useComposedRefs(...e){return s.useCallback(composeRefs(...e),e)}},7256:function(e,t,r){"use strict";r.d(t,{Z8:function(){return createSlot},g7:function(){return c}});var s=r(2265),n=r(2210),a=r(7437);function createSlot(e){let t=function(e){let t=s.forwardRef((e,t)=>{let{children:r,...a}=e;if(s.isValidElement(r)){let e,c;let o=(e=Object.getOwnPropertyDescriptor(r.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?r.ref:(e=Object.getOwnPropertyDescriptor(r,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?r.props.ref:r.props.ref||r.ref,i=function(e,t){let r={...t};for(let s in t){let n=e[s],a=t[s],c=/^on[A-Z]/.test(s);c?n&&a?r[s]=(...e)=>{let t=a(...e);return n(...e),t}:n&&(r[s]=n):"style"===s?r[s]={...n,...a}:"className"===s&&(r[s]=[n,a].filter(Boolean).join(" "))}return{...e,...r}}(a,r.props);return r.type!==s.Fragment&&(i.ref=t?(0,n.F)(t,o):o),s.cloneElement(r,i)}return s.Children.count(r)>1?s.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}(e),r=s.forwardRef((e,r)=>{let{children:n,...c}=e,o=s.Children.toArray(n),i=o.find(isSlottable);if(i){let e=i.props.children,n=o.map(t=>t!==i?t:s.Children.count(e)>1?s.Children.only(null):s.isValidElement(e)?e.props.children:null);return(0,a.jsx)(t,{...c,ref:r,children:s.isValidElement(e)?s.cloneElement(e,void 0,n):null})}return(0,a.jsx)(t,{...c,ref:r,children:n})});return r.displayName=`${e}.Slot`,r}var c=createSlot("Slot"),o=Symbol("radix.slottable");function isSlottable(e){return s.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===o}}},function(e){e.O(0,[250,971,472,744],function(){return e(e.s=1779)}),_N_E=e.O()}]);